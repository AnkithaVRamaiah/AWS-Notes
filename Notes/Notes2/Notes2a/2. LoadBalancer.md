# **AWS Load Balancers ‚Äì Complete Notes with Examples**

## **Introduction to Load Balancing**
Load balancing is the process of distributing incoming network traffic across multiple servers to ensure no single server becomes overwhelmed. It improves **availability, reliability, and scalability** of applications.

AWS provides **Elastic Load Balancing (ELB)**, which automatically distributes incoming traffic across multiple **EC2 instances, containers, or IP addresses**.

## **Types of AWS Load Balancers**
AWS offers **four types** of load balancers:

1. **Application Load Balancer (ALB)**
2. **Network Load Balancer (NLB)**
3. **Gateway Load Balancer (GWLB)**
4. **Classic Load Balancer (CLB)** *(Older generation, not recommended for new applications)*

---

## **1. Application Load Balancer (ALB)**
ALB is designed for **HTTP(S) and WebSocket traffic**. It operates at **Layer 7 (Application Layer)** and provides **intelligent routing** based on content.

### **Features of ALB**
‚úÖ **Content-Based Routing** ‚Üí Routes requests based on URL path, headers, query parameters.  
‚úÖ **Host-Based Routing** ‚Üí Directs traffic to different backend services based on domain names.  
‚úÖ **Path-Based Routing** ‚Üí Routes traffic based on the URL path (e.g., `/api` vs. `/images`).  
‚úÖ **Supports Containers (ECS, EKS)** ‚Üí Can route traffic to multiple containers using dynamic port mapping.  
‚úÖ **WebSockets Support** ‚Üí Used for real-time applications like chat applications.  
‚úÖ **Authentication & Security** ‚Üí Supports AWS WAF (Web Application Firewall) & user authentication.  
‚úÖ **Automatic Scaling** ‚Üí Scales based on demand using **Auto Scaling Groups**.  

### **Example Use Case of ALB**
**Scenario:**  
A web application has **two services**:
1. `/api` ‚Üí Backend API
2. `/static` ‚Üí Frontend static content

**Solution:**
- **ALB** directs API requests to one set of EC2 instances and frontend requests to another.
- Uses **Path-Based Routing**:
  - `example.com/api` ‚Üí Routes to **Backend EC2 instances**
  - `example.com/static` ‚Üí Routes to **Frontend EC2 instances**

### **When to Use ALB?**
‚úî Web applications with **multiple microservices** (APIs, frontend, backend).  
‚úî Applications requiring **user authentication** (OAuth, Cognito, etc.).  
‚úî Services using **containers (ECS, EKS, Fargate)**.  
‚úî When you need **WAF (Web Application Firewall)** for security.  

---

## **2. Network Load Balancer (NLB)**
NLB is designed for **high-performance and low-latency applications**. It operates at **Layer 4 (Transport Layer)** and handles **millions of requests per second**.

### **Features of NLB**
‚úÖ **TCP, UDP, TLS Support** ‚Üí Ideal for applications requiring **low latency** (e.g., gaming, real-time streaming).  
‚úÖ **Static IP Address** ‚Üí Unlike ALB, NLB provides **fixed IP addresses**.  
‚úÖ **Preserves Source IP** ‚Üí Allows backend servers to see the real client IP address.  
‚úÖ **Cross-Zone Load Balancing** ‚Üí Distributes traffic across multiple **AWS Availability Zones (AZs)**.  
‚úÖ **Supports AWS PrivateLink** ‚Üí Connects applications privately inside AWS.  

### **Example Use Case of NLB**
**Scenario:**  
A **high-performance stock trading system** requires a load balancer that can handle **millions of TCP requests per second**.

**Solution:**  
- **NLB** distributes TCP connections to multiple backend servers.  
- It ensures **low latency and high throughput**.  
- Uses a **Static IP Address** for consistent DNS resolution.  

### **When to Use NLB?**
‚úî Applications requiring **TCP/UDP traffic** (e.g., DNS servers, gaming applications).  
‚úî **High-performance applications** needing ultra-low latency.  
‚úî Applications needing a **fixed IP address** for whitelisting (e.g., enterprise apps).  
‚úî **Internal AWS services using AWS PrivateLink**.  

---

## **3. Gateway Load Balancer (GWLB)**
GWLB is used for **network appliances like firewalls, intrusion detection systems (IDS), and security tools**. It operates at **Layer 3 (Network Layer)**.

### **Features of GWLB**
‚úÖ **Transparent Load Balancing** ‚Üí Routes traffic without modifying packets.  
‚úÖ **Supports Security Appliances** ‚Üí Used for firewalls, threat monitoring.  
‚úÖ **High Availability** ‚Üí Automatically distributes traffic across multiple **security appliances**.  
‚úÖ **Works with AWS Transit Gateway** ‚Üí Routes traffic to **firewalls across multiple VPCs**.  

### **Example Use Case of GWLB**
**Scenario:**  
A company wants to **inspect incoming traffic** using a **firewall before it reaches EC2 instances**.

**Solution:**  
- **GWLB** sends all traffic through a **firewall appliance** before forwarding it to backend servers.  
- Ensures **security and compliance** in the AWS environment.  

### **When to Use GWLB?**
‚úî When using **third-party security appliances** (firewalls, IDS/IPS, packet inspection).  
‚úî **Security and compliance** requirements demand **traffic filtering**.  
‚úî Need to inspect **east-west and north-south traffic** in a multi-VPC setup.  

---

## **4. Classic Load Balancer (CLB)**
CLB is the **older generation** of load balancers and operates at **both Layer 4 & Layer 7**.  
It **lacks modern features** and is **not recommended for new applications**.

### **Features of CLB**
‚úÖ Supports **basic load balancing** for HTTP, HTTPS, and TCP applications.  
‚úÖ **Sticky Sessions (Session Persistence)** using cookies.  
‚úÖ **Health Checks** to ensure traffic is sent to healthy instances.  

### **Example Use Case of CLB**
**Scenario:**  
A **legacy application** built on EC2 instances requires **session persistence**.

**Solution:**  
- **CLB** is used to distribute traffic, ensuring **sticky sessions** for session-based applications.  

### **When to Use CLB?**
‚úî Only for **legacy applications** that already use CLB.  
‚ùå Not recommended for new applications (use ALB or NLB instead).  

---

## **Comparison of AWS Load Balancers**

| Feature | **ALB** (Layer 7) | **NLB** (Layer 4) | **GWLB** (Layer 3) | **CLB** (Legacy) |
|---------|------------------|------------------|------------------|------------------|
| **Best For** | Web Applications (HTTP/HTTPS) | High-performance apps (TCP/UDP) | Security appliances (firewalls) | Legacy applications |
| **Routing Type** | Content-based (Host, Path) | Connection-based (TCP, UDP) | Traffic mirroring | Basic round-robin |
| **Performance** | Medium | Ultra-Low Latency | High | Low |
| **Supports WebSockets** | ‚úÖ Yes | ‚ùå No | ‚ùå No | ‚ùå No |
| **Supports AWS WAF** | ‚úÖ Yes | ‚ùå No | ‚ùå No | ‚ùå No |
| **Static IP Support** | ‚ùå No | ‚úÖ Yes | ‚úÖ Yes | ‚ùå No |
| **Best for Microservices?** | ‚úÖ Yes | ‚ùå No | ‚ùå No | ‚ùå No |

---

## **Conclusion: When to Use Which Load Balancer?**
- **Use ALB** ‚Üí For **web applications, microservices**, and **path-based routing**.
- **Use NLB** ‚Üí For **low-latency, TCP/UDP applications**, like real-time gaming or trading platforms.
- **Use GWLB** ‚Üí For **security appliances** like firewalls and **intrusion detection systems**.
- **Use CLB** ‚Üí **Only for legacy applications** (otherwise, use ALB/NLB).

---

## **Example: Deploying ALB with EC2**
### **Steps to Set Up an ALB**
1. **Launch EC2 instances** ‚Üí Create multiple instances to handle traffic.
2. **Create an ALB** in AWS **ELB service**.
3. **Define a Target Group** ‚Üí Add EC2 instances as backend servers.
4. **Configure Listeners** ‚Üí Set HTTP/HTTPS rules (e.g., redirect `/api` requests).
5. **Attach ALB to Route 53 (Optional)** ‚Üí Use a **custom domain**.
6. **Test Load Balancer** ‚Üí Access the ALB **DNS name** and check traffic distribution.

---

## **Final Thoughts**
AWS Load Balancers help **improve performance, scalability, and availability** of applications.  
Choosing the right one depends on the **type of traffic**, **application architecture**, and **performance requirements**.

---

# **AWS Load Balancer**  

## **1Ô∏è‚É£ Interviewer: What is a Load Balancer?**  
üîπ *"A Load Balancer is a service that distributes incoming traffic across multiple servers to ensure high availability and fault tolerance."*  

üìå **Think of it like a traffic police officer** directing cars (requests) to different lanes (servers) to avoid congestion.  

---

## **2Ô∏è‚É£ Interviewer: Why do we need AWS Load Balancer?**  
üîπ *"In cloud environments, applications must handle high traffic and remain available even if a server fails. AWS Load Balancer helps in:"*  

‚úÖ **Distributing traffic** across multiple instances (EC2, containers, Lambda).  
‚úÖ **Handling failures** by redirecting traffic if a server goes down.  
‚úÖ **Scaling applications** dynamically to manage demand.  
‚úÖ **Improving security** by protecting against attacks (DDoS, SSL termination).  

üìå **Example:**  
Imagine you have a website hosted on **three EC2 instances**. If one instance crashes, the Load Balancer **automatically redirects traffic** to the healthy instances, ensuring the website stays live.  

---

## **3Ô∏è‚É£ Interviewer: What are the types of AWS Load Balancers?**  
üîπ *"AWS provides four types of Load Balancers, each suited for different use cases."*  

| Load Balancer | Use Case | Works At |
|--------------|------------|-----------|
| **Application Load Balancer (ALB)** | HTTP/HTTPS traffic (Layer 7) | Application Layer |
| **Network Load Balancer (NLB)** | High-performance, low-latency (Layer 4) | Transport Layer |
| **Gateway Load Balancer (GWLB)** | Security appliances (firewalls, intrusion detection) | Network Layer |
| **Classic Load Balancer (CLB)** | Legacy applications (Deprecated) | Both Layer 4 & 7 |

üìå **Example:**  
- Use **ALB** for **web applications** running on HTTP/HTTPS.  
- Use **NLB** for **gaming servers** that require low latency.  

---

## **4Ô∏è‚É£ Interviewer: Explain Application Load Balancer (ALB)?**  
üîπ *"ALB is a Layer 7 (Application Layer) load balancer used for routing HTTP/HTTPS traffic."*  

### **Key Features:**  
‚úÖ Routes traffic based on **URL paths** (Path-based routing).  
‚úÖ Routes traffic based on **Hostnames** (Host-based routing).  
‚úÖ Supports **WebSocket** and **HTTP/2**.  
‚úÖ Works with **AWS Auto Scaling** and **Containerized apps (ECS, EKS)**.  

üìå **Example:**  
Imagine you have an **e-commerce website**:  
- `www.example.com/shop` ‚Üí Routes traffic to the shopping service.  
- `www.example.com/login` ‚Üí Routes traffic to the authentication service.  

This is **Path-Based Routing**, which ALB supports.  

---

## **5Ô∏è‚É£ Interviewer: Explain Network Load Balancer (NLB)?**  
üîπ *"NLB is a Layer 4 (Transport Layer) load balancer used for high-performance and low-latency applications."*  

### **Key Features:**  
‚úÖ Handles **millions of requests per second**.  
‚úÖ Supports **TCP, UDP, and TLS protocols**.  
‚úÖ Ideal for **real-time gaming, financial apps, and VoIP services**.  
‚úÖ Provides a **static IP** for clients to connect to.  

üìå **Example:**  
- A **stock trading** application needs ultra-low latency (milliseconds).  
- NLB routes traffic directly to EC2 instances **without delays**.  

---

## **6Ô∏è‚É£ Interviewer: Explain Gateway Load Balancer (GWLB)?**  
üîπ *"GWLB is designed to distribute traffic across security appliances like firewalls, intrusion detection systems (IDS), and deep packet inspection (DPI)."*  

### **Key Features:**  
‚úÖ Automatically scales **firewalls, IDS/IPS solutions**.  
‚úÖ Simplifies deployment of **third-party security solutions**.  
‚úÖ Works at **Layer 3 (Network Layer)** using **GWLBe endpoints**.  

üìå **Example:**  
- A company wants **centralized security** for all VPCs.  
- GWLB sends traffic to a **firewall appliance** before reaching the application servers.  

---

## **7Ô∏è‚É£ Interviewer: What is a Classic Load Balancer (CLB)?**  
üîπ *"CLB is an older version of ALB & NLB, supporting both Layer 4 & Layer 7."*  

### **Key Features:**  
‚úÖ Works at **both Layer 4 & 7**, but lacks advanced features.  
‚úÖ Used for **legacy applications**.  
‚úÖ Not recommended for new projects (ALB & NLB are better).  

üìå **Example:**  
- A company running an **old Java-based application** on EC2 might still use CLB.  

---

## **8Ô∏è‚É£ Interviewer: How does AWS Load Balancer work?**  
üîπ *"AWS Load Balancer distributes traffic using a concept called **Target Groups**."*  

### **Step-by-Step Working:**  
‚úÖ **Step 1:** Client sends a request (HTTP, TCP, UDP).  
‚úÖ **Step 2:** Load Balancer receives the request.  
‚úÖ **Step 3:** It checks **rules** (Path-based, Host-based, IP-based).  
‚úÖ **Step 4:** The request is forwarded to the appropriate **Target Group**.  
‚úÖ **Step 5:** The response is sent back to the client.  

üìå **Example:**  
- A **Load Balancer with two target groups**:  
  - `www.example.com/api` ‚Üí Goes to API servers.  
  - `www.example.com/images` ‚Üí Goes to Image servers.  

---

## **9Ô∏è‚É£ Interviewer: How does Auto Scaling work with Load Balancers?**  
üîπ *"Auto Scaling automatically adds or removes EC2 instances based on traffic. Load Balancer distributes requests evenly among them."*  

üìå **Example:**  
- If website traffic **increases**, Auto Scaling **adds** new EC2 instances.  
- If traffic **drops**, Auto Scaling **removes** instances to save costs.  

üí° **Tip:** Load Balancers ensure that even if new instances are added, users experience **zero downtime**.  

---

## **üîü Interviewer: What are the benefits of AWS Load Balancer?**  

| Benefit | Explanation |
|---------|------------|
| **High Availability** | Spreads traffic across multiple instances. |
| **Fault Tolerance** | Detects and replaces failed instances. |
| **Security** | Supports SSL termination and integrates with AWS WAF. |
| **Auto Scaling Integration** | Works seamlessly with EC2 Auto Scaling. |
| **Traffic Optimization** | Reduces latency and improves performance. |

üìå **Example:**  
- If an EC2 instance fails, the Load Balancer **removes it from rotation** and sends traffic to healthy instances.  

---

## **1Ô∏è‚É£1Ô∏è‚É£ Interviewer: How do you configure an ALB in AWS?**  
üîπ *"Setting up an Application Load Balancer is simple."*  

‚úÖ **Step 1:** Go to **AWS EC2 Console** ‚Üí Load Balancers.  
‚úÖ **Step 2:** Click **Create Load Balancer** ‚Üí Choose **ALB**.  
‚úÖ **Step 3:** Set up a **Listener** (HTTP/HTTPS).  
‚úÖ **Step 4:** Choose or create a **Target Group**.  
‚úÖ **Step 5:** Attach **EC2 Instances**.  
‚úÖ **Step 6:** Configure security settings (SSL, WAF, Security Groups).  
‚úÖ **Step 7:** Review and Create.  

üìå **Outcome:** The ALB starts distributing traffic among instances.  

---

## **1Ô∏è‚É£2Ô∏è‚É£ Interviewer: What is the pricing of AWS Load Balancers?**  
üí∞ **AWS Load Balancer costs depend on:**  
- **Load Balancer Hours** ($0.022 per hour for ALB).  
- **Data Processed** (per GB).  
- **Rules Configured** (For ALB).  

üìå **Example:**  
- If an ALB runs **24/7** for a month, it costs ~$16.  

---

## **Final Answer Summary (For Quick Recall)**  

üîπ **AWS Load Balancer ensures high availability, fault tolerance, and security for applications.**  
üîπ There are **four types:** ALB (Layer 7), NLB (Layer 4), GWLB (Security), CLB (Legacy).  
üîπ Supports **Auto Scaling, Path-based & Host-based routing, and SSL termination.**  
üîπ Works with **EC2, ECS, Lambda, and Kubernetes (EKS).**  
üîπ **Reduces downtime and improves performance** by routing traffic efficiently.  

---

üí° **Tip:** If asked, *"Have you worked with AWS Load Balancers?"*, say:  
*"Yes! I have set up Application Load Balancers for routing web traffic and integrated them with Auto Scaling Groups to handle dynamic traffic. I have also configured NLB for low-latency applications."*  

