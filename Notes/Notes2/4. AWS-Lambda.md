# **AWS Lambda **  

AWS Lambda is one of the most popular **serverless computing** services that lets you run code **without managing servers**. AWS automatically takes care of **provisioning, scaling, and billing**‚Äîyou just write the code, and it runs when triggered.  

---

# **What Problem Does AWS Lambda Solve?**  
Before Lambda, if you wanted to run code, you had to:  
1. **Set up an EC2 instance (virtual machine).**  
2. **Manage servers, install dependencies, and scale resources manually.**  
3. **Pay for EC2 24/7, even when your application isn't used.**  

With AWS Lambda:  
‚úÖ **No servers to manage** ‚Äì AWS runs your code automatically.  
‚úÖ **Only pay when the function runs** ‚Äì No idle costs.  
‚úÖ **Auto-scales** ‚Äì Handles multiple requests at once without manual scaling.  
‚úÖ **Event-driven execution** ‚Äì Runs only when triggered, reducing waste.  

---

# **Where Can We Use AWS Lambda? (Real-World Examples)**  
‚úÖ **Image Resizing in S3:** Automatically resize images when uploaded to Amazon S3.  
‚úÖ **API Backend:** Handle requests from API Gateway to process user requests.  
‚úÖ **Data Processing:** Stream data processing with AWS Kinesis.  
‚úÖ **Automated Alerts:** Send emails or SMS using SNS when an event occurs.  
‚úÖ **Security Automation:** Auto-stop EC2 instances if unauthorized changes are detected.  

---
## **How AWS Lambda Works?

1Ô∏è‚É£ **Event Occurs (Triggering Lambda)**  
   - Something happens that **triggers Lambda** (e.g., a file is uploaded to S3, an API request is made, or a CloudWatch alarm is triggered).  

2Ô∏è‚É£ **AWS Automatically Runs Your Code**  
   - AWS takes the **code you wrote** and **executes it on-demand**.  
   - You don‚Äôt need to start or stop any servers.  

3Ô∏è‚É£ **Lambda Performs the Task**  
   - Your function processes the event (e.g., resizes an image, saves data to a database, or sends an alert).  

4Ô∏è‚É£ **Lambda Returns the Output**  
   - If it‚Äôs an API request, it returns a response.  
   - If it‚Äôs a background task, it completes the work and stops automatically.  

5Ô∏è‚É£ **You Pay Only for the Execution Time**  
   - If Lambda runs for **2 seconds, you pay only for those 2 seconds**‚Äînothing when it‚Äôs idle.  

---

## **Example 1: Automatically Resizing an Image in S3**  
### **Scenario:**  
- A user **uploads an image** to an S3 bucket.  
- **S3 triggers Lambda**.  
- **Lambda resizes the image** and saves it back to S3.  

üîπ **Step 1:** User uploads `photo.jpg` to S3.  
üîπ **Step 2:** S3 event **triggers** Lambda.  
üîπ **Step 3:** Lambda **resizes the image** using Python code.  
üîπ **Step 4:** Resized image is saved back to S3 (`resized-photo.jpg`).  

```python
import boto3
from PIL import Image
import io

s3 = boto3.client("s3")

def lambda_handler(event, context):
    bucket = event['Records'][0]['s3']['bucket']['name']
    key = event['Records'][0]['s3']['object']['key']
    
    # Download image
    file_obj = s3.get_object(Bucket=bucket, Key=key)
    image = Image.open(io.BytesIO(file_obj['Body'].read()))

    # Resize image
    image = image.resize((200, 200))

    # Save back to S3
    buffer = io.BytesIO()
    image.save(buffer, "JPEG")
    buffer.seek(0)
    
    s3.put_object(Bucket=bucket, Key="resized-" + key, Body=buffer, ContentType="image/jpeg")

    return {"statusCode": 200, "body": "Image resized successfully"}
```

**Outcome:** Every time a user uploads an image, Lambda **automatically resizes it**! üéâ  

---

## **Example 2: Sending an Alert When CPU Usage is High**  
### **Scenario:**  
- **CloudWatch detects** that an EC2 instance‚Äôs CPU usage is above 70%.  
- **CloudWatch triggers Lambda**.  
- **Lambda sends an email alert** using SNS.  

üîπ **Step 1:** CloudWatch notices CPU usage **crosses 70%**.  
üîπ **Step 2:** CloudWatch **triggers Lambda** function.  
üîπ **Step 3:** Lambda **sends an email** using SNS.  

```python
import boto3

sns = boto3.client('sns')

def lambda_handler(event, context):
    message = "ALERT: CPU usage has exceeded 70%!"
    topic_arn = "arn:aws:sns:us-east-1:123456789012:HighCPUAlert"

    sns.publish(TopicArn=topic_arn, Message=message, Subject="High CPU Usage Alert")

    return {"statusCode": 200, "body": "Alert sent successfully"}
```

**Outcome:** Lambda automatically **sends an email** whenever CPU usage goes too high! üì©  

---

## **Key Features of AWS Lambda**  
‚úÖ **Event-Driven** ‚Äì Runs **only when triggered**, saving costs.  
‚úÖ **No Server Management** ‚Äì AWS **handles all infrastructure**.  
‚úÖ **Auto-Scales** ‚Äì Can handle **1 request or 1 million requests**.  
‚úÖ **Multiple Language Support** ‚Äì Python, Node.js, Java, Go, etc.  
‚úÖ **Pay-Per-Use** ‚Äì **Only pay when it runs**, no idle charges.  

---

# **How to Use AWS Lambda (Step-by-Step with Examples)**  

### **Example 1: Trigger Lambda When a File is Uploaded to S3**  
### **Scenario:**  
- When a user uploads an image to S3, Lambda will resize it and save it back to S3.  

### **Steps to Implement:**  
1. **Create an S3 Bucket** (e.g., `my-image-bucket`).  
2. **Go to AWS Lambda** ‚Üí Click **Create Function** ‚Üí Choose **Python 3.9**.  
3. **Set an S3 Trigger** to execute Lambda when a file is uploaded.  
4. **Write Lambda Code to Resize the Image:**  

#### **Python Code for Image Resizing in AWS Lambda**  
```python
import boto3
from PIL import Image
import io

s3 = boto3.client("s3")

def lambda_handler(event, context):
    bucket = event['Records'][0]['s3']['bucket']['name']
    key = event['Records'][0]['s3']['object']['key']
    
    # Download the image from S3
    file_obj = s3.get_object(Bucket=bucket, Key=key)
    image = Image.open(io.BytesIO(file_obj['Body'].read()))

    # Resize the Image
    image = image.resize((200, 200))

    # Save back to S3
    buffer = io.BytesIO()
    image.save(buffer, "JPEG")
    buffer.seek(0)
    
    s3.put_object(Bucket=bucket, Key="resized-" + key, Body=buffer, ContentType="image/jpeg")

    return {"statusCode": 200, "body": "Image resized successfully"}
```

### **How This Works?**  
1. A user **uploads an image** to S3 (`my-image-bucket`).  
2. The S3 event **triggers AWS Lambda**.  
3. Lambda **downloads the image**, resizes it, and **uploads it back** as `resized-filename.jpg`.  

---

### **Example 2: Sending an Email When CPU Usage is High (CloudWatch + Lambda + SNS)**  
### **Scenario:**  
- If **CPU usage of an EC2 instance** goes above 70%, CloudWatch triggers Lambda.  
- Lambda sends an **email alert using AWS SNS**.  

### **Steps to Implement:**  
1. **Set up a CloudWatch Alarm** for EC2 **CPU Utilization > 70%**.  
2. **Create an SNS Topic** (Amazon Simple Notification Service) and subscribe with an email.  
3. **Create a Lambda Function** to publish a message to SNS.  
4. **CloudWatch triggers Lambda** when CPU usage exceeds the threshold.  

#### **Python Code for Sending an Alert via SNS**  
```python
import boto3

sns = boto3.client('sns')

def lambda_handler(event, context):
    message = "ALERT: CPU usage has exceeded 70%!"
    topic_arn = "arn:aws:sns:us-east-1:123456789012:HighCPUAlert"  # Replace with your SNS ARN

    # Publish message to SNS topic
    response = sns.publish(
        TopicArn=topic_arn,
        Message=message,
        Subject="High CPU Usage Alert"
    )

    return {"statusCode": 200, "body": "Alert sent successfully"}
```

### **How This Works?**  
1. **EC2 CPU usage goes above 70%**.  
2. **CloudWatch triggers Lambda**.  
3. **Lambda sends an email** using SNS to notify the admin.  

---

### **Example 3: Building a Serverless API Using Lambda + API Gateway**  
### **Scenario:**  
- Create an API endpoint (`/hello`) that returns `Hello, World!` when called.  

### **Steps to Implement:**  
1. **Go to AWS Lambda** ‚Üí Create a function.  
2. **Go to API Gateway** ‚Üí Create a new HTTP API.  
3. **Connect API Gateway to the Lambda function.**  
4. **Deploy API** and get a public endpoint.  

#### **Python Code for Lambda API**  
```python
def lambda_handler(event, context):
    return {
        "statusCode": 200,
        "body": "Hello, World!"
    }
```

### **How This Works?**  
1. **User calls the API** (`https://api-id.execute-api.us-east-1.amazonaws.com/hello`).  
2. **API Gateway triggers Lambda**.  
3. **Lambda returns the response** `"Hello, World!"`.  

---

# **Advantages of AWS Lambda** üöÄ  
‚úÖ **No Servers to Manage** ‚Äì AWS takes care of everything.  
‚úÖ **Auto-Scaling** ‚Äì Scales up/down automatically.  
‚úÖ **Cost-Effective** ‚Äì You pay only when your function runs.  
‚úÖ **Event-Driven Execution** ‚Äì Runs only when needed, saving resources.  
‚úÖ **Supports Multiple Languages** ‚Äì Python, Node.js, Java, Go, etc.  

---

# **Disadvantages of AWS Lambda** ‚ùå  
‚ö† **Cold Start Issue** ‚Äì First execution after inactivity takes longer.  
‚ö† **Execution Time Limit** ‚Äì Max **15 minutes per function**.  
‚ö† **Limited Storage & Memory** ‚Äì Max **10GB disk space and 10GB RAM**.  
‚ö† **Not Ideal for Long-Running Tasks** ‚Äì Meant for short executions.  

---

# **Conclusion**  
AWS Lambda is a **powerful serverless computing tool** that allows you to run code **without managing servers**. It‚Äôs perfect for **automating tasks, processing data, building APIs, and real-time monitoring**.  

